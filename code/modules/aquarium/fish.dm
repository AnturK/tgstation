// Fish path used for autogenerated fish
/obj/item/fish
	name = "generic looking aquarium fish"
	desc = "very bland"
	w_class = WEIGHT_CLASS_TINY

/// Automatically generates object of given base path from the behaviour type in loc
/proc/generate_fish(loc,behaviour_type,base_path=/obj/item/fish)
	var/datum/aquarium_behaviour/behaviour = behaviour_type
	var/obj/item/fish = new /obj/item/fish(loc)
	fish.name = initial(behaviour.name)
	fish.icon = initial(behaviour.icon)
	fish.icon_state = initial(behaviour.icon_state)
	fish.desc = initial(behaviour.desc)
	if(initial(behaviour.color))
		fish.add_atom_colour(initial(behaviour.color), FIXED_COLOUR_PRIORITY)
	if(ispath(behaviour_type,/datum/aquarium_behaviour/fish))
		var/datum/aquarium_behaviour/fish/fish_behaviour = behaviour_type
		var/fillet_type = initial(fish_behaviour.fillet_type)
		if(fillet_type)
			fish.AddElement(/datum/element/processable, TOOL_KNIFE, fillet_type, 1, 5)
	fish.AddElement(/datum/element/deferred_aquarium_content, behaviour_type)
	return fish

/// Returns random fish, using random_case_rarity probabilities.
/proc/random_fish_type(case_fish_only=TRUE,required_fluid)
	var/static/probability_table
	var/argkey = "fish_[required_fluid]_[case_fish_only]" //If this expands more extract bespoke element arg generation to some common helper.
	if(!probability_table || !probability_table[argkey])
		if(!probability_table)
			probability_table = list()
		var/chance_table = list()
		for(var/_fish_behavior in subtypesof(/datum/aquarium_behaviour/fish))
			var/datum/aquarium_behaviour/fish/fish_behavior = _fish_behavior
			if(required_fluid && initial(fish_behavior.required_fluid_type) != required_fluid)
				continue
			if(initial(fish_behavior.availible_in_random_cases) || !case_fish_only)
				chance_table[fish_behavior] = initial(fish_behavior.random_case_rarity)
		probability_table[argkey] = chance_table
	return pickweight(probability_table[argkey])

// Actual fish definitions below - there's no specific paths, they are autogenerated from behaviours

// Freshwater fish

/datum/aquarium_behaviour/fish/goldfish
	name = "goldfish"
	desc = "Not actually made of gold."
	icon_state = "goldfish"
	sprite_width = 8
	sprite_height = 8

/datum/aquarium_behaviour/fish/angelfish
	name = "angelfish"
	desc = "Omnivore fish originating from Amazon River."
	icon_state = "angelfish"
	dedicated_in_aquarium_icon_state = "bigfish"
	sprite_height = 7
	source_height = 7

/datum/aquarium_behaviour/fish/guppy
	name = "guppy"
	desc = "One of the most popular aquarium fish."
	icon_state = "guppy"
	dedicated_in_aquarium_icon_state = "fish_greyscale"
	aquarium_vc_color = "#91AE64"
	sprite_width = 8
	sprite_height = 5

/datum/aquarium_behaviour/fish/plasmatetra
	name = "plasma tetra"
	desc = "Tetra fish with coloring similar to plasma."
	icon_state = "plastetra"
	dedicated_in_aquarium_icon_state = "fish_greyscale"
	aquarium_vc_color = "#D30EB0"

/datum/aquarium_behaviour/fish/catfish
	name = "cory catfish"
	desc = "Unrelated to actual cats."
	icon_state = "catfish"
	dedicated_in_aquarium_icon_state = "fish_greyscale"
	aquarium_vc_color = "#907420"

/datum/aquarium_behaviour/fish/spacecarp
	name = "space carp"
	desc = "This space predator fish is known to cause yearly damage to space stations during their migrations."
	icon_state = "carp"
	sprite_width = 8
	sprite_height = 8
	availible_in_random_cases = FALSE

// Saltwater fish below

/datum/aquarium_behaviour/fish/clownfish
	name = "clownfish"
	desc = "Honk!"
	icon_state = "clownfish"
	dedicated_in_aquarium_icon_state = "clownfish_small"
	required_fluid_type = AQUARIUM_FLUID_SALTWATER
	sprite_width = 8
	sprite_height = 5

/datum/aquarium_behaviour/fish/cardinal
	name = "cardinalfish"
	desc = "Small saltwater fish active at night."
	icon_state = "cardinalfish"
	dedicated_in_aquarium_icon_state = "fish_greyscale"
	required_fluid_type = AQUARIUM_FLUID_SALTWATER

/datum/aquarium_behaviour/fish/greenchromis
	name = "green chromis"
	desc = "Small fish with distinctive green sheen."
	icon_state = "greenchromis"
	dedicated_in_aquarium_icon_state = "fish_greyscale"
	aquarium_vc_color = "#00ff00"
	required_fluid_type = AQUARIUM_FLUID_SALTWATER

/datum/aquarium_behaviour/fish/firefish
	name = "firefish goby"
	desc = "Long thing two-colored fish."
	icon_state = "firefish"
	sprite_width = 6
	sprite_height = 5
	required_fluid_type = AQUARIUM_FLUID_SALTWATER

/datum/aquarium_behaviour/fish/pufferfish
	name = "pufferfish"
	desc = "I'll let reviewers write these dang descriptions."
	icon_state = "pufferfish"
	required_fluid_type = AQUARIUM_FLUID_SALTWATER
	sprite_width = 8
	sprite_height = 8

/datum/aquarium_behaviour/fish/lanternfish
	name = "lanternfish"
	desc = "Terror of the deep."
	icon_state = "lanternfish"
	required_fluid_type = AQUARIUM_FLUID_SALTWATER
	random_case_rarity = FISH_RARITY_VERY_RARE
	source_width = 28
	source_height = 21
	sprite_width = 8
	sprite_height = 8
